# üöÄ GUIA COMPLETO: Integra√ß√£o Meta (WhatsApp, Instagram, Messenger)

**Do ZERO ao FUNCIONAMENTO COMPLETO**
**Tempo total:** 20-30 minutos
**√öltima atualiza√ß√£o:** 18 de Outubro de 2025

---

## üìã √çNDICE

1. [Escolher M√©todo WhatsApp](#1-escolher-m√©todo-whatsapp)
2. [M√©todo R√°pido: WhatsApp QR Code (5 min)](#2-m√©todo-r√°pido-whatsapp-qr-code)
3. [M√©todo Avan√ßado: API Oficial Meta (30 min)](#3-m√©todo-avan√ßado-api-oficial-meta)
4. [Instagram (Opcional)](#4-instagram-opcional)
5. [Messenger (Opcional)](#5-messenger-opcional)
6. [Testar Integra√ß√µes](#6-testar-integra√ß√µes)

---

## 1. ESCOLHER M√âTODO WHATSAPP

### ü§î Qual m√©todo usar?

| Caracter√≠stica | QR Code ‚ö° | API Oficial üè¢ |
|----------------|-----------|----------------|
| **Tempo configura√ß√£o** | 5 minutos | 30-45 minutos |
| **Dificuldade** | F√°cil ‚≠ê | Dif√≠cil ‚≠ê‚≠ê‚≠ê‚≠ê |
| **Aprova√ß√£o Meta** | N√£o precisa ‚úÖ | Precisa ‚ùå |
| **Conta WhatsApp** | Usa sua conta ‚úÖ | Precisa criar nova ‚ùå |
| **Custo** | Gr√°tis ‚úÖ | Pode ter custo |
| **Templates aprovados** | N√£o ‚ùå | Sim ‚úÖ |
| **Envio em massa** | Limitado ‚ö†Ô∏è | Ilimitado ‚úÖ |
| **Estabilidade** | Boa ‚úÖ | Excelente ‚úÖ‚úÖ |

### üí° Recomenda√ß√£o:

- **üü¢ Use QR Code** se:
  - Quer come√ßar AGORA
  - Tem menos de 500 conversas/m√™s
  - N√£o precisa de templates aprovados
  - Quer testar o sistema primeiro

- **üîµ Use API Oficial** se:
  - Precisa de templates aprovados pelo Meta
  - Vai enviar muitas mensagens (1000+/m√™s)
  - Quer bot√µes interativos oficiais
  - Neg√≥cio j√° est√° estabelecido

**üëâ DICA:** Comece com QR Code, migre para API depois se precisar!

---

## 2. M√âTODO R√ÅPIDO: WHATSAPP QR CODE

### ‚ö° 5 MINUTOS - MAIS F√ÅCIL

### 2.1 Acessar Integra√ß√µes

1. Acesse: **https://connectia.agenciapixel.digital/integracoes**
2. Fa√ßa login (se n√£o estiver logado)
3. Encontre o card **"WhatsApp"**

### 2.2 Conectar via QR Code

1. Clique em **"Conectar"** ou **"Conectar via QR Code"**
2. Um QR Code vai aparecer na tela
3. No seu celular:
   - Abra o **WhatsApp**
   - Toque nos **3 pontinhos** (‚ãÆ menu)
   - Toque em **"Aparelhos conectados"**
   - Toque em **"Conectar um aparelho"**
   - **Escaneie o QR Code** da tela

### 2.3 Confirmar Conex√£o

1. Aguarde 5-10 segundos
2. Ver√°: **"WhatsApp Conectado ‚úÖ"**
3. Pronto! Pode fechar

### 2.4 Testar

1. Envie uma mensagem para o n√∫mero conectado
2. V√° em **Caixa de Entrada** no Connect IA
3. A mensagem deve aparecer l√°
4. Responda pelo sistema
5. Deve chegar no WhatsApp

### ‚úÖ PRONTO! WhatsApp funcionando!

**Pule para:** [Se√ß√£o 6: Testar Integra√ß√µes](#6-testar-integra√ß√µes)

---

## 3. M√âTODO AVAN√áADO: API OFICIAL META

### üè¢ 30-45 MINUTOS - MAIS COMPLETO

### 3.1 Criar App Meta

#### Passo 1: Acessar Meta for Developers

1. Acesse: https://developers.facebook.com/
2. Fa√ßa login com sua conta Meta/Facebook
3. Clique em **"My Apps"** (canto superior direito)
4. Clique em **"Create App"**

#### Passo 2: Configurar App

1. Tipo de app: **"Business"**
2. Clique em **"Next"**
3. Preencha:
   - **Display Name:** `Connect IA`
   - **App Contact Email:** `ricardo@agenciapixel.digital`
   - **Business Account:** Selecione ou crie uma
4. Clique em **"Create App"**
5. Resolva o captcha se pedir

#### Passo 3: Obter Credenciais

1. Menu lateral ‚Üí **"Settings"** ‚Üí **"Basic"**
2. Voc√™ ver√°:
   - **App ID:** `670209849105494` (copie)
   - **App Secret:** Clique em **"Show"** ‚Üí Digite senha ‚Üí Copie
3. **‚ö†Ô∏è GUARDE ESSAS INFORMA√á√ïES!**

### 3.2 Configurar Dom√≠nio

1. Ainda em **Settings** ‚Üí **Basic**
2. Adicione em **"App Domains":**
   ```
   agenciapixel.digital
   ```
3. Em **"Website"** ‚Üí **Site URL:**
   ```
   https://connectia.agenciapixel.digital
   ```
4. Role at√© o final e adicione:
   - **Privacy Policy URL:**
     ```
     https://connectia.agenciapixel.digital/politica-privacidade
     ```
   - **Terms of Service URL:**
     ```
     https://connectia.agenciapixel.digital/termos-de-servico
     ```
   - **User Data Deletion URL:**
     ```
     https://connectia.agenciapixel.digital/exclusao-dados
     ```
5. Clique em **"Save Changes"**

### 3.3 Adicionar WhatsApp Business

#### Passo 1: Adicionar Produto

1. Menu lateral ‚Üí **"Add Products"**
2. Encontre **"WhatsApp"**
3. Clique em **"Set Up"**

#### Passo 2: Criar Conta WhatsApp Business

1. Clique em **"Create New WhatsApp Business Account"**
2. Preencha:
   - **Business Name:** `Ag√™ncia Pixel - Connect IA`
   - **Category:** `Marketing / Advertising`
3. Clique em **"Continue"**

#### Passo 3: Adicionar N√∫mero

**Op√ß√£o A - N√∫mero de Teste (Desenvolvimento):**
1. Meta fornece n√∫meros de teste gratuitos
2. Use para testar

**Op√ß√£o B - N√∫mero Real (Produ√ß√£o):**
1. Digite seu n√∫mero: `+55 11 98765-4321`
2. Meta envia SMS com c√≥digo
3. Digite o c√≥digo
4. Confirme

### 3.4 Configurar Webhook WhatsApp

#### Passo 1: Ir para Configuration

1. Menu lateral ‚Üí **"WhatsApp"** ‚Üí **"Configuration"**
2. Se√ß√£o **"Webhook"** ‚Üí Clique em **"Edit"**

#### Passo 2: Configurar URL

**‚ö†Ô∏è IMPORTANTE:** Use a Edge Function do Supabase!

```
Callback URL: https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/whatsapp-webhook
Verify Token: connect_ia_webhook_2025
```

**Explica√ß√£o:**
- `bjsuujkbrhjhuyzydxbr` = Seu Project ID do Supabase
- `/functions/v1/` = Caminho das Edge Functions
- `whatsapp-webhook` = Nome da fun√ß√£o (j√° existe no seu projeto)
- `connect_ia_webhook_2025` = Token que voc√™ define

#### Passo 3: Salvar e Subscribe

1. Clique em **"Verify and Save"**
2. Se der erro, verifique se Edge Function est√° rodando
3. Ap√≥s salvar, clique em **"Manage"** (Webhook Fields)
4. Marque:
   - ‚úÖ `messages`
   - ‚úÖ `message_status`
5. Clique em **"Subscribe"**

### 3.5 Gerar Token Permanente

**‚ö†Ô∏è IMPORTANTE:** N√£o use temporary token (expira em 24h)!

#### Passo 1: Criar System User

1. Acesse: https://business.facebook.com/settings/system-users
2. Clique em **"Add"**
3. Preencha:
   - **Name:** `Connect IA System User`
   - **Role:** **Admin**
4. Clique em **"Create System User"**

#### Passo 2: Gerar Token

1. Clique no System User criado
2. Clique em **"Generate New Token"**
3. Selecione App: **"Connect IA"**
4. Marque permiss√µes:
   - ‚úÖ `whatsapp_business_management`
   - ‚úÖ `whatsapp_business_messaging`
5. Clique em **"Generate Token"**
6. **COPIE O TOKEN** (n√£o ser√° mostrado novamente!)

#### Passo 3: Atribuir Assets

1. No System User, clique em **"Assign Assets"**
2. Aba **"Apps":**
   - Marque: **Connect IA**
   - Permiss√µes: **Full Control**
   - **Save Changes**
3. Aba **"WhatsApp Accounts":**
   - Marque sua conta WhatsApp Business
   - Permiss√µes: **Full Control**
   - **Save Changes**

### 3.6 Obter IDs Necess√°rios

#### Phone Number ID:

1. **WhatsApp** ‚Üí **"API Setup"**
2. Na se√ß√£o **"Phone Numbers"**
3. O ID est√° abaixo do n√∫mero
4. Formato: `123456789012345`
5. **Copie!**

#### Business Account ID:

1. **WhatsApp** ‚Üí **"API Setup"**
2. No topo, clique em configura√ß√µes ‚öôÔ∏è
3. Copie o **"WhatsApp Business Account ID"**
4. Formato: `123456789012345`

### 3.7 Adicionar ao .env

Crie/edite o arquivo `.env.production`:

```bash
# Meta App Credentials
VITE_META_APP_ID=670209849105494
META_APP_SECRET=seu_app_secret_aqui

# WhatsApp Business API
WHATSAPP_ACCESS_TOKEN=EAAJZCcpy...seu_token_permanente_aqui
WHATSAPP_VERIFY_TOKEN=connect_ia_webhook_2025
WHATSAPP_PHONE_NUMBER_ID=123456789012345
WHATSAPP_BUSINESS_ACCOUNT_ID=123456789012345
```

### 3.8 Passar App para LIVE

**‚ö†Ô∏è IMPORTANTE:** S√≥ fa√ßa isso quando tudo estiver testado!

#### Checklist antes de Live:

- [ ] Privacy Policy URL funcionando
- [ ] Terms of Service URL funcionando
- [ ] Data Deletion URL funcionando
- [ ] Webhook configurado e testado
- [ ] Token permanente salvo
- [ ] Testado em modo Development

#### Passar para Live:

1. **Settings** ‚Üí **Basic**
2. No topo: Status **"Development"**
3. Clique no switch para mudar para **"Live"**
4. Confirme
5. Pronto! App p√∫blico!

---

## 4. INSTAGRAM (Opcional)

### üì∏ 15-20 MINUTOS

### 4.1 Adicionar Produto

1. Menu lateral ‚Üí **"Add Products"**
2. **"Instagram"** ‚Üí **"Set Up"**

### 4.2 Conectar Conta

1. Clique em **"Connect Instagram Account"**
2. Login na conta Instagram Business
3. Selecione p√°gina Facebook associada
4. Autorize

### 4.3 Configurar Webhook

**Webhook (se necess√°rio):**

```
Callback URL: https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/instagram-webhook
Verify Token: connect_ia_webhook_2025
```

### 4.4 Gerar Token

Use o mesmo System User do WhatsApp ou gere novo:

1. Permiss√µes:
   - ‚úÖ `instagram_basic`
   - ‚úÖ `instagram_manage_messages`
   - ‚úÖ `instagram_manage_comments`

### 4.5 Obter Instagram Business ID

1. **Instagram** ‚Üí **"Configuration"**
2. ID est√° vis√≠vel na p√°gina
3. Copie

### 4.6 Adicionar ao .env

```bash
# Instagram Business API
INSTAGRAM_ACCESS_TOKEN=seu_token_instagram_aqui
INSTAGRAM_BUSINESS_ACCOUNT_ID=17841400000000000
```

---

## 5. MESSENGER (Opcional)

### üí¨ 15-20 MINUTOS

### 5.1 Adicionar Produto

1. Menu lateral ‚Üí **"Add Products"**
2. **"Messenger"** ‚Üí **"Set Up"**

### 5.2 Conectar P√°gina

1. Clique em **"Add or Remove Pages"**
2. Selecione sua p√°gina Facebook
3. Autorize

### 5.3 Configurar Webhook

**‚ö†Ô∏è Nota:** Voc√™ pode precisar criar a Edge Function `messenger-webhook`

```
Callback URL: https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/messenger-webhook
Verify Token: connect_ia_webhook_2025
```

**Subscribe to:**
- ‚úÖ `messages`
- ‚úÖ `messaging_postbacks`
- ‚úÖ `messaging_optins`
- ‚úÖ `message_deliveries`
- ‚úÖ `message_reads`

### 5.4 Gerar Token

1. **Messenger** ‚Üí **"Settings"**
2. Se√ß√£o **"Access Tokens"**
3. Selecione sua p√°gina
4. **"Generate Token"**
5. Copie

### 5.5 Obter Page ID

1. Acesse sua p√°gina Facebook
2. **Sobre** ‚Üí Role at√© o final
3. Ou use: https://findmyfbid.com/

### 5.6 Adicionar ao .env

```bash
# Messenger API
MESSENGER_ACCESS_TOKEN=seu_token_messenger_aqui
MESSENGER_PAGE_ID=123456789012345
MESSENGER_VERIFY_TOKEN=connect_ia_webhook_2025
```

---

## 6. TESTAR INTEGRA√á√ïES

### üß™ TESTES FINAIS

### 6.1 Testar WhatsApp

#### Se usou QR Code:

1. Envie mensagem para o n√∫mero conectado
2. V√° em: https://connectia.agenciapixel.digital/caixa-entrada
3. Mensagem deve aparecer
4. Responda pelo sistema
5. Deve chegar no WhatsApp

#### Se usou API Oficial:

1. Envie mensagem do seu celular para o n√∫mero Business
2. Verifique logs:
   - Dashboard Supabase ‚Üí Functions ‚Üí whatsapp-webhook ‚Üí Logs
3. Mensagem deve aparecer nos logs
4. Aparece no Connect IA ‚Üí Caixa de Entrada
5. Teste resposta

### 6.2 Testar Instagram (se configurou)

1. Envie DM para conta Instagram Business
2. Veja logs: Functions ‚Üí instagram-webhook ‚Üí Logs
3. Aparece no Connect IA
4. Teste resposta

### 6.3 Testar Messenger (se configurou)

1. Envie mensagem para p√°gina Facebook
2. Veja logs: Functions ‚Üí messenger-webhook ‚Üí Logs
3. Aparece no Connect IA
4. Teste resposta

---

## 7. CONFIGURAR AGENTES IA (Opcional)

### ü§ñ RESPOSTAS AUTOM√ÅTICAS

### 7.1 Criar Agente IA

1. Acesse: https://connectia.agenciapixel.digital/agentes-ia
2. Clique em **"Criar Agente"**
3. Preencha:
   - **Nome:** `Atendente Virtual`
   - **Descri√ß√£o:** `Responde automaticamente no WhatsApp`
   - **Prompt/Instru√ß√µes:** Como o agente deve responder
4. Ative para WhatsApp
5. Salve

### 7.2 Testar Agente

1. Envie mensagem teste
2. Agente deve responder automaticamente
3. Ajuste o prompt se necess√°rio

---

## 8. ARQUIVO .env COMPLETO

### üìù TEMPLATE FINAL

```bash
# =====================================================
# SUPABASE
# =====================================================
VITE_SUPABASE_URL=https://bjsuujkbrhjhuyzydxbr.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# =====================================================
# META APP
# =====================================================

# App Credentials
VITE_META_APP_ID=670209849105494
META_APP_SECRET=seu_app_secret_aqui

# WhatsApp Business API (API Oficial)
WHATSAPP_ACCESS_TOKEN=token_permanente_system_user
WHATSAPP_VERIFY_TOKEN=connect_ia_webhook_2025
WHATSAPP_PHONE_NUMBER_ID=123456789012345
WHATSAPP_BUSINESS_ACCOUNT_ID=123456789012345

# Instagram Business API (Opcional)
INSTAGRAM_ACCESS_TOKEN=seu_token_instagram
INSTAGRAM_BUSINESS_ACCOUNT_ID=17841400000000000

# Messenger API (Opcional)
MESSENGER_ACCESS_TOKEN=seu_token_messenger
MESSENGER_PAGE_ID=123456789012345
MESSENGER_VERIFY_TOKEN=connect_ia_webhook_2025

# =====================================================
# APLICA√á√ÉO
# =====================================================
VITE_APP_URL=https://connectia.agenciapixel.digital
NODE_ENV=production
```

---

## 9. TROUBLESHOOTING

### ‚ùå Erro: "Webhook Verification Failed"

**Causas:**
- Edge Function n√£o est√° rodando
- Verify Token diferente
- Edge Function retorna erro

**Solu√ß√µes:**
1. Teste URL no navegador
2. Verifique logs da Edge Function
3. Confirme verify token: `connect_ia_webhook_2025`

### ‚ùå Erro: "Invalid Access Token"

**Causas:**
- Token tempor√°rio expirou (24h)
- Token sem permiss√µes

**Solu√ß√µes:**
1. Gere token via System User (nunca expira)
2. Marque todas permiss√µes necess√°rias
3. Atribua assets ao System User

### ‚ùå QR Code n√£o aparece

**Solu√ß√µes:**
1. Verifique console do navegador (F12)
2. Edge Function `whatsapp-qr-connect` est√° ativa?
3. Teste: https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/whatsapp-qr-connect

### ‚ùå Mensagens n√£o chegam

**Verificar:**
1. WhatsApp est√° conectado? (QR Code)
2. Webhook subscribed? (API Oficial)
3. Edge Function rodando?
4. Logs t√™m erros?

---

## 10. PR√ìXIMOS PASSOS

### ‚úÖ Ap√≥s tudo funcionando:

1. **Configure Agentes IA** para respostas autom√°ticas
2. **Importe Contatos** no CRM
3. **Crie Campanhas** de marketing
4. **Monitore Dashboard** com m√©tricas
5. **Escale** conforme crescer

---

## üìû SUPORTE

### Links √öteis:

- **Connect IA:** https://connectia.agenciapixel.digital
- **Meta Developers:** https://developers.facebook.com/
- **Supabase Dashboard:** https://supabase.com/dashboard/project/bjsuujkbrhjhuyzydxbr
- **Documenta√ß√£o Meta WhatsApp:** https://developers.facebook.com/docs/whatsapp

### Contato:

- **Email:** ricardo@agenciapixel.digital
- **Empresa:** Ag√™ncia Pixel

---

## ‚úÖ CHECKLIST FINAL

- [ ] **M√©todo escolhido:** QR Code ou API Oficial
- [ ] **WhatsApp configurado**
- [ ] **Webhook testado** (se API Oficial)
- [ ] **Tokens salvos no .env**
- [ ] **Instagram configurado** (se usar)
- [ ] **Messenger configurado** (se usar)
- [ ] **Teste enviando mensagem**
- [ ] **Teste recebendo mensagem**
- [ ] **Teste resposta pelo sistema**
- [ ] **Agente IA configurado** (opcional)
- [ ] **Tudo funcionando ‚úÖ**

---

**√öltima atualiza√ß√£o:** 18 de Outubro de 2025
**Vers√£o:** 2.0 - Guia Unificado
**Status:** Completo e Testado ‚úÖ

**Bora integrar! üöÄ**
