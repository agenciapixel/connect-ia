# üéØ **CONFIGURA√á√ÉO META COMPLETA - CONNECT IA**

## **üìã RESUMO EXECUTIVO**

**Produtos Necess√°rios:**
- ‚úÖ **Login do Facebook para Empresas** (essencial)
- ‚úÖ **WhatsApp** (principal canal)
- ‚úÖ **Instagram** (inbox para atendimento)
- ‚úÖ **Webhook** (essencial para receber mensagens)

**Produto para Remover:**
- ‚ùå **Messenger** (n√£o necess√°rio)

---

## **üîß PASSO A PASSO - META FOR DEVELOPERS**

### **PASSO 1: Acessar Meta for Developers**
1. **Acesse:** [Meta for Developers](https://developers.facebook.com/)
2. **Fa√ßa login** com sua conta
3. **Selecione** seu app Connect IA

### **PASSO 2: Remover Messenger (Otimiza√ß√£o)**
1. **V√° em:** Products ‚Üí **Messenger**
2. **Clique:** Remove Product
3. **Confirme** a remo√ß√£o
4. **Aguarde** confirma√ß√£o

### **PASSO 3: Verificar WhatsApp**
1. **V√° em:** Products ‚Üí **WhatsApp**
2. **Verifique** se est√° ativo
3. **Clique** em "Set up" se necess√°rio
4. **Anote** as credenciais necess√°rias

### **PASSO 4: Verificar Instagram**
1. **V√° em:** Products ‚Üí **Instagram Basic Display**
2. **Verifique** se est√° ativo
3. **Clique** em "Set up" se necess√°rio
4. **Anote** as credenciais necess√°rias

### **PASSO 5: Configurar Webhook**
1. **V√° em:** Products ‚Üí **Webhook**
2. **Verifique** se est√° ativo
3. **Configure** as URLs de webhook

---

## **üéØ PERMISS√ïES NECESS√ÅRIAS**

### **WhatsApp Business API:**
```
whatsapp_business_management
whatsapp_business_messaging
pages_show_list
pages_messaging
```

### **Instagram Basic Display:**
```
instagram_basic
instagram_manage_messages
pages_show_list
pages_messaging
```

### **Webhook:**
```
webhook_subscriptions
```

### **Facebook Login:**
```
email
public_profile
pages_show_list
```

---

## **üì± CONFIGURA√á√ÉO DOS CANAIS**

### **1. üü¢ WHATSAPP BUSINESS**

**Credenciais Necess√°rias:**
- **Phone Number ID:** `123456789012345`
- **Business Account ID:** `987654321098765`
- **Access Token:** `EAAG...`
- **Verify Token:** `meu_token_seguro_123` (voc√™ cria)

**Webhook URL:**
```
https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/whatsapp-webhook
```

**Configura√ß√£o no Meta:**
1. **Meta for Developers** ‚Üí **WhatsApp** ‚Üí **Configuration**
2. **Webhook URL:** Cole a URL acima
3. **Verify Token:** Use o mesmo token do formul√°rio
4. **Subscribe to:** `messages`
5. **Clique:** Verify and Save

### **2. üü¢ INSTAGRAM INBOX**

**Credenciais Necess√°rias:**
- **Access Token:** `INSTAGRAM_ACCESS_TOKEN`
- **Page ID:** `INSTAGRAM_PAGE_ID`

**Webhook URL:**
```
https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/instagram-webhook
```

**Configura√ß√£o no Meta:**
1. **Meta for Developers** ‚Üí **Instagram Basic Display** ‚Üí **Configuration**
2. **Webhook URL:** Cole a URL acima
3. **Subscribe to:** `messages`
4. **Clique:** Save

### **3. üü¢ WEBHOOK GERAL**

**URLs de Webhook Dispon√≠veis:**
```
WhatsApp: https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/whatsapp-webhook
Instagram: https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/instagram-webhook
```

**Eventos Suportados:**
- `messages` - Receber mensagens
- `message_deliveries` - Status de entrega
- `message_reads` - Status de leitura

---

## **üîó INTEGRA√á√ÉO NO SISTEMA CONNECT IA**

### **WhatsApp Setup:**
1. **Abra Connect IA**
2. **V√° em:** Integra√ß√µes ‚Üí WhatsApp
3. **Clique:** "Conectar Canal WhatsApp"
4. **Preencha o formul√°rio:**
   ```
   Nome do Canal: WhatsApp Vendas
   Phone Number ID: 123456789012345
   Business Account ID: 987654321098765
   Access Token: EAAG...
   Verify Token: meu_token_seguro_123
   ```
5. **Clique:** Conectar

### **Instagram Setup:**
1. **V√° em:** Integra√ß√µes ‚Üí Instagram
2. **Clique:** "Conectar Canal Instagram"
3. **Preencha o formul√°rio:**
   ```
   Nome do Canal: Instagram Inbox
   Access Token: [Instagram Access Token]
   Page ID: [Instagram Page ID]
   ```
4. **Clique:** Conectar

---

## **üìä FUNCIONALIDADES DISPON√çVEIS**

### **WhatsApp Business:**
- ‚úÖ **Envio de mensagens** de texto
- ‚úÖ **Envio de imagens** e documentos
- ‚úÖ **Mensagens template** (aprovadas pelo Meta)
- ‚úÖ **Webhook** para receber mensagens
- ‚úÖ **Respostas autom√°ticas** via IA
- ‚úÖ **Campanhas** de marketing
- ‚úÖ **Status de entrega** e leitura

### **Instagram Inbox:**
- ‚úÖ **Envio de mensagens** diretas
- ‚úÖ **Envio de m√≠dia** (imagens, v√≠deos)
- ‚úÖ **Webhook** para receber mensagens
- ‚úÖ **Respostas autom√°ticas** via IA
- ‚úÖ **Gest√£o de conversas**
- ‚úÖ **Integra√ß√£o** com CRM
- ‚úÖ **Status de entrega** e leitura

### **Webhook:**
- ‚úÖ **Recebimento** de mensagens em tempo real
- ‚úÖ **Processamento** autom√°tico de eventos
- ‚úÖ **Integra√ß√£o** com sistema de CRM
- ‚úÖ **Logs** de atividade
- ‚úÖ **Monitoramento** de status

---

## **üéØ FLUXO DE ATENDIMENTO**

### **Cen√°rio 1: Cliente envia mensagem no WhatsApp**
1. **Webhook** recebe a mensagem em tempo real
2. **Sistema** processa e identifica o contato
3. **IA** gera resposta autom√°tica
4. **Atendente** pode intervir se necess√°rio
5. **Conversa** fica salva no CRM
6. **Status** de entrega/leitura √© monitorado

### **Cen√°rio 2: Cliente envia mensagem no Instagram**
1. **Webhook** recebe a mensagem em tempo real
2. **Sistema** processa e identifica o contato
3. **IA** gera resposta autom√°tica
4. **Atendente** pode intervir se necess√°rio
5. **Conversa** fica salva no CRM
6. **Status** de entrega/leitura √© monitorado

---

## **üìã CHECKLIST COMPLETO**

### **Meta for Developers:**
- [ ] Remover produto Messenger
- [ ] Verificar WhatsApp ativo
- [ ] Verificar Instagram Basic Display ativo
- [ ] Verificar Webhook ativo
- [ ] Configurar webhook do WhatsApp
- [ ] Configurar webhook do Instagram
- [ ] Configurar eventos do Webhook
- [ ] Verificar permiss√µes necess√°rias
- [ ] Testar webhooks

### **Sistema Connect IA:**
- [ ] Conectar canal WhatsApp
- [ ] Conectar canal Instagram
- [ ] Testar envio de mensagens
- [ ] Verificar recebimento de mensagens
- [ ] Testar webhook em tempo real
- [ ] Configurar respostas autom√°ticas
- [ ] Testar integra√ß√£o com CRM
- [ ] Verificar logs de webhook

---

## **üß™ TESTES DE FUNCIONALIDADE**

### **Teste WhatsApp:**
```bash
curl -X POST https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/whatsapp-send-message \
  -H "Authorization: Bearer YOUR_SUPABASE_ANON_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "to": "5511999999999",
    "message": "Teste de conex√£o WhatsApp",
    "channelId": "your_whatsapp_channel_id"
  }'
```

### **Teste Instagram:**
```bash
curl -X POST https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/instagram-send-message \
  -H "Authorization: Bearer YOUR_SUPABASE_ANON_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "to": "instagram_user_id",
    "message": "Teste de conex√£o Instagram",
    "channelId": "your_instagram_channel_id"
  }'
```

### **Teste Webhook:**
```bash
curl -X POST https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/whatsapp-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "object": "whatsapp_business_account",
    "entry": [{
      "id": "WHATSAPP_BUSINESS_ACCOUNT_ID",
      "changes": [{
        "value": {
          "messaging_product": "whatsapp",
          "metadata": {
            "display_phone_number": "15551234567",
            "phone_number_id": "PHONE_NUMBER_ID"
          },
          "messages": [{
            "from": "5511999999999",
            "id": "wamid.test123",
            "timestamp": "1234567890",
            "text": {
              "body": "Teste de webhook"
            },
            "type": "text"
          }]
        },
        "field": "messages"
      }]
    }]
  }'
```

---

## **‚ö†Ô∏è PROBLEMAS COMUNS E SOLU√á√ïES**

### **WhatsApp:**
- **Erro:** `Invalid access token`
  - **Solu√ß√£o:** Verificar se o token est√° correto e n√£o expirou

- **Erro:** `Phone number not found`
  - **Solu√ß√£o:** Verificar o Phone Number ID no Meta

- **Erro:** `Webhook verification failed`
  - **Solu√ß√£o:** Verificar se o Verify Token √© o mesmo

### **Instagram:**
- **Erro:** `Instagram access token invalid`
  - **Solu√ß√£o:** Verificar se o token do Instagram est√° correto

- **Erro:** `Page not found`
  - **Solu√ß√£o:** Verificar se a p√°gina do Instagram est√° conectada

### **Webhook:**
- **Erro:** `Webhook endpoint not responding`
  - **Solu√ß√£o:** Verificar se as URLs est√£o corretas e acess√≠veis

- **Erro:** `Invalid webhook signature`
  - **Solu√ß√£o:** Verificar configura√ß√£o de assinatura no Meta

---

## **üìà BENEF√çCIOS DA CONFIGURA√á√ÉO**

### **WhatsApp + Instagram + Webhook:**
- üéØ **Cobertura completa** dos principais canais
- üì± **Atendimento unificado** em uma plataforma
- ü§ñ **IA automatizada** para ambos os canais
- üìä **CRM integrado** para todos os contatos
- üöÄ **Escalabilidade** para crescimento
- ‚ö° **Tempo real** com webhooks
- üìà **Monitoramento** de status e m√©tricas

### **Otimiza√ß√£o:**
- ‚úÖ **Menos produtos** = aprova√ß√£o mais r√°pida
- ‚úÖ **Foco nos canais** que realmente usa
- ‚úÖ **Manuten√ß√£o simplificada**
- ‚úÖ **Menos complexidade** t√©cnica
- ‚úÖ **Webhook essencial** para funcionamento

---

## **üéØ PR√ìXIMOS PASSOS**

### **1. Otimizar no Meta:**
1. Remover Messenger
2. Verificar WhatsApp, Instagram e Webhook ativos
3. Configurar webhooks
4. Configurar eventos do webhook

### **2. Configurar no Sistema:**
1. Conectar canal WhatsApp
2. Conectar canal Instagram
3. Testar funcionalidades
4. Testar webhook em tempo real

### **3. Configurar IA:**
1. Criar agentes de IA
2. Configurar respostas autom√°ticas
3. Treinar para ambos os canais
4. Configurar monitoramento

---

## **üîß CONFIGURA√á√ÉO ESPEC√çFICA DO WEBHOOK**

### **Eventos a Configurar:**
- `messages` - Receber mensagens
- `message_deliveries` - Status de entrega
- `message_reads` - Status de leitura

### **URLs de Webhook:**
```
WhatsApp: https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/whatsapp-webhook
Instagram: https://bjsuujkbrhjhuyzydxbr.supabase.co/functions/v1/instagram-webhook
```

### **Verifica√ß√£o de Webhook:**
1. **Meta for Developers** ‚Üí **Webhook**
2. **Teste** as URLs de webhook
3. **Verifique** se est√£o respondendo
4. **Configure** os eventos necess√°rios

---

## **üìã RESUMO FINAL**

**Produtos Configurados:**
- ‚úÖ **Login do Facebook para Empresas**
- ‚úÖ **WhatsApp Business API**
- ‚úÖ **Instagram Basic Display**
- ‚úÖ **Webhook**

**Funcionalidades:**
- üì± **Atendimento unificado** WhatsApp + Instagram
- ü§ñ **IA automatizada** para respostas
- üìä **CRM integrado** com todos os contatos
- ‚ö° **Webhook em tempo real** para mensagens
- üìà **Monitoramento** de status e m√©tricas

**Benef√≠cios:**
- üöÄ **Aprova√ß√£o mais r√°pida** no Meta
- üîß **Manuten√ß√£o simplificada**
- üí∞ **Menos complexidade** t√©cnica
- üéØ **Foco nos canais** essenciais

---

**üéâ CONFIGURA√á√ÉO COMPLETA!**

**Agora voc√™ tem tudo configurado para o Connect IA funcionar perfeitamente com WhatsApp, Instagram e Webhook. Esta √© a configura√ß√£o ideal para aprova√ß√£o r√°pida no Meta for Developers.**
