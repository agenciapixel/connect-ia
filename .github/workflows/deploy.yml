# GitHub Actions desabilitado - usando Git Deploy da Hostinger
# O Git Deploy da Hostinger Ã© mais confiÃ¡vel e nÃ£o requer credenciais FTP

name: Build Only (Git Deploy da Hostinger)

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build-only:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        
    - name: Install dependencies
      run: npm install
      
    - name: Clean and Build project
      run: |
        echo "ğŸ§¹ Limpando build anterior..."
        rm -rf dist/
        rm -rf node_modules/.vite/
        
        echo "ğŸ”¨ Fazendo build limpo do sistema React..."
        npm run build
        
        echo "ğŸ“ Verificando arquivos gerados:"
        ls -la dist/
        
        echo "ğŸ“„ ConteÃºdo do index.html:"
        cat dist/index.html
        
        echo "ğŸ“„ Arquivos JavaScript gerados:"
        ls -la dist/assets/*.js || echo "Nenhum arquivo JS encontrado"
        
        echo "ğŸ“„ Primeiras linhas do JavaScript:"
        head -10 dist/assets/*.js || echo "Nenhum arquivo JS para mostrar"
      
    - name: Copy dist files to root for Hostinger Git Deploy
      run: |
        echo "ğŸ“ Copiando arquivos da pasta dist/ para a raiz..."
        cp -r dist/* . || echo "âš ï¸ Erro ao copiar arquivos"
        ls -la
        echo "âœ… Arquivos copiados para a raiz"
        
    - name: Commit built files locally
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add .
        git commit -m "Build: Deploy compiled files to root for Hostinger Git Deploy" || exit 0
        echo "âœ… Arquivos compilados commitados na raiz"
        
    - name: Notify build completion
      run: |
        echo "âœ… Build concluÃ­do!"
        echo "ğŸ“ Arquivos compilados copiados para a raiz"
        echo "âš ï¸  Push manual necessÃ¡rio para atualizar repositÃ³rio"
        echo "ğŸ“‹ PrÃ³ximos passos:"
        echo "   1. Fazer pull do repositÃ³rio local"
        echo "   2. Fazer push para atualizar GitHub"
        echo "   3. Git Deploy da Hostinger farÃ¡ deploy automÃ¡tico"
        echo "   4. Arquivos estarÃ£o disponÃ­veis em:"
        echo "      - https://connectia.agenciapixel.digital/assets/index-AY6h670N.js"
        echo "      - https://connectia.agenciapixel.digital/assets/index-BE4tGbRk.css"
        echo "      - https://connectia.agenciapixel.digital/favicon.ico"
        echo "ğŸŒ Site: https://connectia.agenciapixel.digital"